<html>
<head>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script type="text/javascript">
    google.load('visualization', '1.1', {packages: ['line']});
    google.setOnLoadCallback(drawChart);

    function convertLogsToRows(logs) {

      var rows = [];
      for (i = 0; i < logs.length; i++) {
        // TODO add timestamp
        rows[i] = [i, logs[i].value];
      }
      return rows;
    }

    function drawChart() {

      var data = new google.visualization.DataTable();
      data.addColumn('number', 'Time');
      data.addColumn('number', 'Value');

      var options = {
        chart: {
          title: 'Box Office Earnings in First Two Weeks of Opening',
          subtitle: 'in millions of dollars (USD)'
        },
        width: 900,
        height: 500
      };

      var chart = new google.charts.Line(document.getElementById('linechart_material'));

      // draw chart
      $.get("/log", function(logs, status) {
        data.addRows(convertLogsToRows(logs));
        chart.draw(data, options);
      });
    }
  </script>
</head>
<body>
  <div id="linechart_material"></div>
</body>
</html>

